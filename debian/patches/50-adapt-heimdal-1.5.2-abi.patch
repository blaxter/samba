Index: samba/source4/heimdal/kdc/default_config.c
===================================================================
--- samba.orig/source4/heimdal/kdc/default_config.c	2015-10-04 19:43:27.223833533 +0200
+++ samba/source4/heimdal/kdc/default_config.c	2015-10-04 19:44:58.189226386 +0200
@@ -51,9 +51,9 @@
     c->require_preauth = TRUE;
     c->kdc_warn_pwexpire = 0;
     c->encode_as_rep_as_tgs_rep = FALSE;
-    c->as_use_strongest_session_key = FALSE;
+    c->tgt_use_strongest_session_key = FALSE;
     c->preauth_use_strongest_session_key = FALSE;
-    c->tgs_use_strongest_session_key = FALSE;
+    c->svc_use_strongest_session_key = FALSE;
     c->use_strongest_server_key = TRUE;
     c->check_ticket_addresses = TRUE;
     c->allow_null_ticket_addresses = TRUE;
@@ -120,9 +120,9 @@
     }
 #endif
 
-    c->as_use_strongest_session_key =
+    c->tgt_use_strongest_session_key =
 	krb5_config_get_bool_default(context, NULL,
-				     c->as_use_strongest_session_key,
+				     c->tgt_use_strongest_session_key,
 				     "kdc",
 				     "as-use-strongest-session-key", NULL);
     c->preauth_use_strongest_session_key =
@@ -130,9 +130,9 @@
 				     c->preauth_use_strongest_session_key,
 				     "kdc",
 				     "preauth-use-strongest-session-key", NULL);
-    c->tgs_use_strongest_session_key =
+    c->svc_use_strongest_session_key =
 	krb5_config_get_bool_default(context, NULL,
-				     c->tgs_use_strongest_session_key,
+				     c->svc_use_strongest_session_key,
 				     "kdc",
 				     "tgs-use-strongest-session-key", NULL);
     c->use_strongest_server_key =
Index: samba/source4/heimdal/kdc/kdc.h
===================================================================
--- samba.orig/source4/heimdal/kdc/kdc.h	2015-10-04 19:43:27.223833533 +0200
+++ samba/source4/heimdal/kdc/kdc.h	2015-10-04 19:44:58.189226386 +0200
@@ -59,9 +59,9 @@
 
     krb5_boolean encode_as_rep_as_tgs_rep; /* bug compatibility */
 
-    krb5_boolean as_use_strongest_session_key;
+    krb5_boolean tgt_use_strongest_session_key;
     krb5_boolean preauth_use_strongest_session_key;
-    krb5_boolean tgs_use_strongest_session_key;
+    krb5_boolean svc_use_strongest_session_key;
     krb5_boolean use_strongest_server_key;
 
     krb5_boolean check_ticket_addresses;
Index: samba/source4/heimdal/kdc/kerberos5.c
===================================================================
--- samba.orig/source4/heimdal/kdc/kerberos5.c	2015-10-04 19:43:27.224833537 +0200
+++ samba/source4/heimdal/kdc/kerberos5.c	2015-10-04 19:44:58.190226390 +0200
@@ -1118,7 +1118,7 @@
      * enctype that an older version of a KDC in the same realm can't
      * decrypt.
      */
-    ret = _kdc_find_etype(context, config->as_use_strongest_session_key, FALSE,
+    ret = _kdc_find_etype(context, config->tgt_use_strongest_session_key, FALSE,
 			  client, b->etype.val, b->etype.len, &sessionetype,
 			  NULL);
     if (ret) {
Index: samba/source4/heimdal/kdc/krb5tgs.c
===================================================================
--- samba.orig/source4/heimdal/kdc/krb5tgs.c	2015-10-04 19:43:27.224833537 +0200
+++ samba/source4/heimdal/kdc/krb5tgs.c	2015-10-04 19:44:58.190226390 +0200
@@ -1726,7 +1726,7 @@
 	    Key *skey;
 
 	    ret = _kdc_find_etype(context,
-				  config->tgs_use_strongest_session_key, FALSE,
+				  config->svc_use_strongest_session_key, FALSE,
 				  server, b->etype.val, b->etype.len, NULL,
 				  &skey);
 	    if(ret) {
Index: samba/source4/kdc/kdc.c
===================================================================
--- samba.orig/source4/kdc/kdc.c	2015-10-04 19:43:27.225833542 +0200
+++ samba/source4/kdc/kdc.c	2015-10-04 19:44:58.191226394 +0200
@@ -957,8 +957,8 @@
 	 * s4:heimdal: import lorikeet-heimdal-201107150856
 	 * (commit 48936803fae4a2fb362c79365d31f420c917b85b)
 	 *
-	 * as_use_strongest_session_key,preauth_use_strongest_session_key
-	 * and tgs_use_strongest_session_key are input to the
+	 * tgt_use_strongest_session_key,preauth_use_strongest_session_key
+	 * and svc_use_strongest_session_key are input to the
 	 * _kdc_find_etype() function. The old bahavior is in
 	 * the use_strongest_session_key=FALSE code path.
 	 * (The only remaining difference in _kdc_find_etype()
@@ -967,9 +967,9 @@
 	 * The old behavior in the _kdc_get_preferred_key()
 	 * function is use_strongest_server_key=TRUE.
 	 */
-	kdc->config->as_use_strongest_session_key = false;
+	kdc->config->tgt_use_strongest_session_key = false;
 	kdc->config->preauth_use_strongest_session_key = false;
-	kdc->config->tgs_use_strongest_session_key = false;
+	kdc->config->svc_use_strongest_session_key = false;
 	kdc->config->use_strongest_server_key = true;
 
 	/* Register hdb-samba4 hooks for use as a keytab */
